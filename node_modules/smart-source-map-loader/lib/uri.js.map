{"version":3,"file":"uri.js","names":["decodePercents","s","decodeURIComponent","err","data","uri","m1","match","mediaInfo","base64","test","mediaType","substring","length","mimeType","split","m2","charset","body","Buffer","from"],"sources":["../src/uri.mjs"],"sourcesContent":["/**\n * Decode percents in string.\n *\n * @param {string} s The string to decode.\n * @returns {string|null} Decoded string or null.\n */\nexport function decodePercents(s) {\n\ttry {\n\t\treturn decodeURIComponent(s);\n\t} catch (err) {\n\t\t// Do nothing.\n\t}\n\treturn null;\n}\n\n/**\n * Parse a data URI.\n *\n * @param {string} uri Data URI.\n * @returns {object} Parsed data.\n */\nexport function data(uri) {\n\tconst m1 = uri.match(/^data:([^,]*),([\\s\\S]*)$/iu);\n\tif (!m1) {\n\t\treturn null;\n\t}\n\tconst [, mediaInfo, data] = m1;\n\tconst base64 = /;base64$/iu.test(mediaInfo);\n\tconst mediaType = base64\n\t\t? mediaInfo.substring(0, mediaInfo.length - 5)\n\t\t: mediaInfo;\n\tconst [mimeType] = mediaType.split(';', 1);\n\tconst m2 = mediaType.match(/;charset=([^;]*)(;|$)/iu);\n\tconst charset = (m2 ? m2[1] : '') || 'US-ASCII';\n\treturn {\n\t\tmediaType,\n\t\tmimeType,\n\t\tcharset,\n\t\tbase64,\n\t\tdata,\n\n\t\t/**\n\t\t * Get body.\n\t\t *\n\t\t * @returns {Buffer} Buffer data.\n\t\t */\n\t\tbody() {\n\t\t\treturn Buffer.from(\n\t\t\t\tdecodePercents(data),\n\t\t\t\tbase64 ? 'base64' : 'utf8'\n\t\t\t);\n\t\t}\n\t};\n}\n"],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACO,SAASA,cAAcA,CAACC,CAAC,EAAE;EACjC,IAAI;IACH,OAAOC,kBAAkB,CAACD,CAAC,CAAC;EAC7B,CAAC,CAAC,OAAOE,GAAG,EAAE;IACb;EAAA;EAED,OAAO,IAAI;AACZ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACO,SAASC,IAAIA,CAACC,GAAG,EAAE;EACzB,MAAMC,EAAE,GAAGD,GAAG,CAACE,KAAK,CAAC,4BAA4B,CAAC;EAClD,IAAI,CAACD,EAAE,EAAE;IACR,OAAO,IAAI;EACZ;EACA,MAAM,GAAGE,SAAS,EAAEJ,IAAI,CAAC,GAAGE,EAAE;EAC9B,MAAMG,MAAM,GAAG,YAAY,CAACC,IAAI,CAACF,SAAS,CAAC;EAC3C,MAAMG,SAAS,GAAGF,MAAM,GACrBD,SAAS,CAACI,SAAS,CAAC,CAAC,EAAEJ,SAAS,CAACK,MAAM,GAAG,CAAC,CAAC,GAC5CL,SAAS;EACZ,MAAM,CAACM,QAAQ,CAAC,GAAGH,SAAS,CAACI,KAAK,CAAC,GAAG,EAAE,CAAC,CAAC;EAC1C,MAAMC,EAAE,GAAGL,SAAS,CAACJ,KAAK,CAAC,yBAAyB,CAAC;EACrD,MAAMU,OAAO,GAAG,CAACD,EAAE,GAAGA,EAAE,CAAC,CAAC,CAAC,GAAG,EAAE,KAAK,UAAU;EAC/C,OAAO;IACNL,SAAS;IACTG,QAAQ;IACRG,OAAO;IACPR,MAAM;IACNL,IAAI;IAEJ;AACF;AACA;AACA;AACA;IACEc,IAAIA,CAAA,EAAG;MACN,OAAOC,MAAM,CAACC,IAAI,CACjBpB,cAAc,CAACI,IAAI,CAAC,EACpBK,MAAM,GAAG,QAAQ,GAAG,MACrB,CAAC;IACF;EACD,CAAC;AACF"}